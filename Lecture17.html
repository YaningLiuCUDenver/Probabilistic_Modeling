<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>17&nbsp; Variations on Brownian Motion and Pricing Stock Options – MATH 4792/5792 Probabilistic Modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Lecture18.html" rel="next">
<link href="./Lecture16.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Lecture17.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Variations on Brownian Motion and Pricing Stock Options</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MATH 4792/5792 Probabilistic Modeling</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Stochastic Processes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Markov Chains</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Classification of States for Markov Chains</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Limiting Probabilities for Markov Chains</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Some Markov Chains Applications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Time Reversible Markov Chains</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hidden Markov Chains</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Exponential Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Further Properties of the Exponential Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Poisson Process</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Further Properties of Poisson Processes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Conditional Distribution of the Arrival Times</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Continuous-Time Markov Chains</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introduction to Queueing Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exponential Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Brownian Motion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture17.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Variations on Brownian Motion and Pricing Stock Options</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Monte Carlo Simulation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">General Techniques for Simulating Continuous Random Variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Special Techniques for Simulating Continuous Random Variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Simulating from Discrete Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Simulating Stochastic Processes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Variance Reduction Techniques-Part I</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Variance Reduction Techniques-Part II</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Lecture25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Variance Reduction Techniques-Part III</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#brownian-motion-with-drift" id="toc-brownian-motion-with-drift" class="nav-link active" data-scroll-target="#brownian-motion-with-drift"><span class="header-section-number">17.1</span> Brownian Motion with Drift</a></li>
  <li><a href="#geometric-brownian-motion" id="toc-geometric-brownian-motion" class="nav-link" data-scroll-target="#geometric-brownian-motion"><span class="header-section-number">17.2</span> Geometric Brownian Motion</a></li>
  <li><a href="#pricing-stock-options" id="toc-pricing-stock-options" class="nav-link" data-scroll-target="#pricing-stock-options"><span class="header-section-number">17.3</span> Pricing Stock Options</a>
  <ul class="collapse">
  <li><a href="#sec-example" id="toc-sec-example" class="nav-link" data-scroll-target="#sec-example"><span class="header-section-number">17.3.1</span> An Example in Options Pricing</a></li>
  <li><a href="#the-arbitrage-theorem" id="toc-the-arbitrage-theorem" class="nav-link" data-scroll-target="#the-arbitrage-theorem"><span class="header-section-number">17.3.2</span> The Arbitrage Theorem</a></li>
  </ul></li>
  <li><a href="#the-black-scholes-option-pricing-formula" id="toc-the-black-scholes-option-pricing-formula" class="nav-link" data-scroll-target="#the-black-scholes-option-pricing-formula"><span class="header-section-number">17.4</span> The Black-Scholes Option Pricing Formula</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Variations on Brownian Motion and Pricing Stock Options</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="brownian-motion-with-drift" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="brownian-motion-with-drift"><span class="header-section-number">17.1</span> Brownian Motion with Drift</h2>
<p>We say that <span class="math inline">\(\{X(t),t\geqslant0\}\)</span> is a Brownian motion process with drift coefficient <span class="math inline">\(\mu\)</span> and variance parameter <span class="math inline">\(\sigma^2\)</span> if</p>
<p>(i<span class="math inline">\()X(0)=0;\)</span></p>
<ol start="2" type="i">
<li><p><span class="math inline">\(\{ X( t)\)</span>, <span class="math inline">\(t\geqslant 0\}\)</span> has stationary and independent increments;</p></li>
<li><p><span class="math inline">\(X(t)\)</span> is normally distributed with mean <span class="math inline">\(\mu t\)</span> and variance <span class="math inline">\(t\sigma^2.\)</span></p></li>
</ol>
<p>An equivalent definition is to let <span class="math inline">\(\{B(t),t\geqslant0\}\)</span> be standard Brownian motion and then define <span class="math display">\[
X(t)=\sigma B(t)+\mu t
\]</span></p>
</section>
<section id="geometric-brownian-motion" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="geometric-brownian-motion"><span class="header-section-number">17.2</span> Geometric Brownian Motion</h2>
<p>If <span class="math inline">\(\left\{Y(t),\:t\geqslant0\right\}\)</span> is a Brownian motion process with drift coefficient <span class="math inline">\(\mu\)</span> and variance parameter <span class="math inline">\(\sigma^2\)</span>, then the process <span class="math inline">\(\{ X( t)\)</span>, <span class="math inline">\(t\geqslant 0\}\)</span> defined by <span class="math display">\[
X(t)=e^{Y(t)}
\]</span> is called <em>geometric Brownian motion</em>.</p>
<p>For a geometric Brownian motion process <span class="math inline">\(\{X(t)\}\)</span>, let us compute the expected value of the process at time <span class="math inline">\(t\)</span> given the history of the process up to time <span class="math inline">\(s\)</span>. That is, for <span class="math inline">\(s&lt;t\)</span>, consider <span class="math inline">\(E[X(t)|X(u),0\leqslant u\leqslant s].\)</span> Now, <span class="math display">\[
\begin{align*}
E[X(t)|X(u),\:0\leqslant u\leqslant s]&amp;=E\big[e^{Y(t)}|Y(u),\:0\leqslant u\leqslant s\big]\\
&amp;=E\big[e^{Y(s)+Y(t)-Y(s)}|Y(u),\:0\leqslant u\leqslant s\big]\\
&amp;=e^{Y(s)}E\Big[e^{Y(t)-Y(s)}|Y(u),\:0\leqslant u\leqslant s\Big]\\
&amp;=X(s)E\Big[e^{Y(t)-Y(s)}\Big]
\end{align*}
\]</span> where the next to last equality follows from the fact that <span class="math inline">\(Y(s)\)</span> is given, and the last equality from the independent increment property of Brownian motion. Now, the moment generating function of a normal random variable <span class="math inline">\(W\)</span> is given by <span class="math display">\[
E[e^{aW}]=e^{aE[W]+a^{2}\operatorname{Var}(W)/2}
\]</span> Hence, since <span class="math inline">\(Y(t)-Y(s)\)</span> is normal with mean <span class="math inline">\(\mu(t-s)\)</span> and variance <span class="math inline">\((t-s)\sigma^2\)</span>, it follows by setting <span class="math inline">\(a=1\)</span> that <span class="math display">\[
E\Big[e^{Y(t)-Y(s)}\Big]=e^{\mu(t-s)+(t-s)\sigma^{2}/2}
\]</span> Thus, we obtain <span id="eq-eq10-8"><span class="math display">\[
E[X(t)|X(u),\:0\leqslant u\leqslant s]=X(s)e^{(t-s)(\mu+\sigma^{2}/2)}
\tag{17.1}\]</span></span></p>
<p>Geometric Brownian motion is useful in the modeling of stock prices over time when you feel that the percentage changes are independent and identically distributed. For instance, suppose that <span class="math inline">\(X_n\)</span> is the price of some stock at time <span class="math inline">\(n.\)</span> Then, it might be reasonable to suppose that <span class="math inline">\(X_n/X_{n-1},n\geqslant1\)</span>, are independent and identically distributed. Let <span class="math display">\[
Y_n=X_n/X_{n-1}
\]</span> and so <span class="math display">\[
X_n=Y_nX_{n-1}
\]</span> Iterating this equality gives <span class="math display">\[
\begin{align*}
X_{n}&amp;=Y_{n}Y_{n-1}X_{n-2}\\
&amp;=Y_{n}Y_{n-1}Y_{n-2}X_{n-3}\\
&amp;\vdots \\
&amp;=Y_{n}Y_{n-1}\cdots Y_{1}X_{0}
\end{align*}
\]</span> Thus, <span class="math display">\[
\log(X_n)=\sum_{i=1}^n\log(Y_i)+\log(X_0)
\]</span></p>
<p>Since <span class="math inline">\(\log(Y_i),i\geqslant1\)</span> are independent and identically distributed, <span class="math inline">\(\{\log(X_n)\}\)</span> will, when suitably normalized, approximately be Brownian motion with a drift, and so <span class="math inline">\(\{X_n\}\)</span> will be approximately geometric Brownian motion.</p>
</section>
<section id="pricing-stock-options" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="pricing-stock-options"><span class="header-section-number">17.3</span> Pricing Stock Options</h2>
<section id="sec-example" class="level3" data-number="17.3.1">
<h3 data-number="17.3.1" class="anchored" data-anchor-id="sec-example"><span class="header-section-number">17.3.1</span> An Example in Options Pricing</h3>
<p>In situations in which money is to be received or paid out in differing time periods, we must take into account the time value of money. That is, to be given the amount <span class="math inline">\(v\)</span> a time <span class="math inline">\(t\)</span> in the future is not worth as much as being given <span class="math inline">\(v\)</span> immediately. The reason for this is that if we were immediately given <span class="math inline">\(v\)</span>, then it could be loaned out with interest and so be worth more than <span class="math inline">\(v\)</span> at time <span class="math inline">\(t\)</span>. To take this into account, we will suppose that the time 0 value, also called the <em>present value</em>, of the amount <span class="math inline">\(v\)</span> to be earned at time <span class="math inline">\(t\)</span> is <span class="math inline">\(ve^{−αt}\)</span> . The quantity <span class="math inline">\(\alpha\)</span> is often called the discount factor. In economic terms, the assumption of the discount function <span class="math inline">\(e^{−αt}\)</span> is equivalent to the assumption that we can earn interest at a continuously compounded rate of <span class="math inline">\(100\alpha\)</span> percent per unit time. <img src="price.png" class="img-fluid" style="width:70.0%"></p>
<p>We will now consider a simple model for pricing an option to purchase a stock at a future time at a fixed price.</p>
<p>Suppose the present price of a stock is $100 per unit share, and suppose we know that after one time period it will be, in present value dollars, either $200 or $50 (see the figure above). It should be noted that the prices at time 1 are the present value (or time 0) prices. That is, if the discount factor is α, then the actual possible prices at time 1 are either <span class="math inline">\(200e^\alpha\)</span> or <span class="math inline">\(50e^\alpha\)</span>. To keep the notation simple, we will suppose that all prices given are time 0 prices.</p>
<p>Suppose that for any <span class="math inline">\(y\)</span>, at a cost of <span class="math inline">\(cy\)</span>, you can purchase at time 0 the option to buy <span class="math inline">\(y\)</span> shares of the stock at time <span class="math inline">\(1\)</span> at a (time 0) cost of $150 per share. Thus, for instance, if you do purchase this option and the stock rises to $200, then you would exercise the option at time 1 and realize a gain of $200 - $150 = $50 for each of the <span class="math inline">\(y\)</span> option units purchased. On the other hand, if the price at time 1 was $50, then the option would be worthless at time 1. In addition, at a cost of <span class="math inline">\(100x\)</span> you can purchase <span class="math inline">\(x\)</span> units of the stock at time 0, and this will be worth either <span class="math inline">\(200x\)</span> or <span class="math inline">\(50x\)</span> at time 1.</p>
<p>We will suppose that both <span class="math inline">\(x\)</span> or <span class="math inline">\(y\)</span> can be either positive or negative (or zero). That is, you can either buy or sell both the stock and the option. For instance, if <span class="math inline">\(x\)</span> were negative then you would be selling <span class="math inline">\(-x\)</span> shares of the stock, yielding you a return of <span class="math inline">\(-100x\)</span>, and you would then be responsible for buying <span class="math inline">\(-x\)</span> shares of the stock at time 1 at a cost of either $200 or $50 per share.</p>
<p>We are interested in determining the appropriate value of <span class="math inline">\(c\)</span>, the unit cost of an option. Specifically, we will show that unless <span class="math inline">\(c = 50/3\)</span> there will be a combination of purchases that will always result in a positive gain.</p>
<p>To show this, suppose that at time 0 we <span class="math display">\[
\begin{align*}
&amp;\text{buy } x \text{ units of stock, and} \\
&amp;\text{buy } y \text{ units of options}
\end{align*}
\]</span> where <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> (which can be either positive or negative) are to be determined. The value of our holding at time 1 depends on the price of the stock at that time; and it is given by the following <span class="math display">\[
\text{value} =
\begin{cases}
200x + 50y, &amp; \text{if price is } 200 \\
50x, &amp; \text{if price is } 50
\end{cases}
\]</span></p>
<p>The preceding formula follows by noting that if the price is 200 then the <span class="math inline">\(x\)</span> units of the stock are worth <span class="math inline">\(200x\)</span>, and the <span class="math inline">\(y\)</span> units of the option to buy the stock at a unit price of <span class="math inline">\(150\)</span> are worth <span class="math inline">\((200 − 150)y\)</span>. On the other hand, if the stock price is <span class="math inline">\(50\)</span>, then the <span class="math inline">\(x\)</span> units are worth <span class="math inline">\(50x\)</span> and the <span class="math inline">\(y\)</span> units of the option are worthless. Now, suppose we choose <span class="math inline">\(y\)</span> to be such that the preceding value is the same no matter what the price at time 1. That is, we choose <span class="math inline">\(y\)</span> so that <span class="math display">\[
200x + 50y = 50x
\]</span> or <span class="math display">\[
y = -3x
\]</span> (Note that <span class="math inline">\(y\)</span> has the opposite sign of <span class="math inline">\(x\)</span>, and so if <span class="math inline">\(x\)</span> is positive and as a result <span class="math inline">\(x\)</span> units of the stock are purchased at time 0, then <span class="math inline">\(3x\)</span> units of stock options are also sold at that time. Similarly, if <span class="math inline">\(x\)</span> is negative, then <span class="math inline">\(-x\)</span> units of stock are sold and <span class="math inline">\(−3x\)</span> units of stock options are purchased at time 0.)</p>
<p>Thus, with <span class="math inline">\(y =−3x\)</span>, the value of our holding at time 1 is <span class="math display">\[
\text{value} = 50x
\]</span> Since the original cost of purchasing <span class="math inline">\(x\)</span> units of the stock and <span class="math inline">\(−3x\)</span> units of options is <span class="math display">\[
\text{original cost} = 100x - 3xc
\]</span> we see that our gain on the transaction is <span class="math display">\[
\text{gain} = 50x − (100x-3xc) = x(3c - 50)
\]</span> Thus, if <span class="math inline">\(3c = 50\)</span>, then the gain is 0; on the other hand if <span class="math inline">\(3c \ne 50\)</span>, we can guarantee a positive gain (no matter what the price of the stock at time 1) by letting <span class="math inline">\(x\)</span> be positive when <span class="math inline">\(3c \gt 50\)</span> and letting it be negative when <span class="math inline">\(3c \lt 50\)</span>.</p>
<p>For instance, if the unit cost per option is <span class="math inline">\(c = 20\)</span>, then purchasing 1 unit of the stock <span class="math inline">\((x = 1)\)</span> and simultaneously selling 3 units of the option <span class="math inline">\((y = -3)\)</span> initially costs us <span class="math inline">\(100-60 = 40\)</span>. However, the value of this holding at time 1 is <span class="math inline">\(50\)</span> whether the stock goes up to <span class="math inline">\(200\)</span> or down to <span class="math inline">\(50\)</span>. Thus, a guaranteed profit of <span class="math inline">\(10\)</span> is attained. Similarly, if the unit cost per option is <span class="math inline">\(c = 15\)</span>, then selling 1 unit of the stock <span class="math inline">\((x = −1)\)</span> and buying 3 units of the option <span class="math inline">\((y = 3)\)</span> leads to an initial gain of <span class="math inline">\(100 - 45 = 55\)</span>. On the other hand, the value of this holding at time 1 is <span class="math inline">\(−50\)</span>. Thus, a guaranteed profit of <span class="math inline">\(5\)</span> is attained.</p>
<p>A sure win betting scheme is called an <em>arbitrage</em>. Thus, as we have just seen, the only option cost <span class="math inline">\(c\)</span> that does not result in an arbitrage is <span class="math inline">\(c = 50/3\)</span>.</p>
</section>
<section id="the-arbitrage-theorem" class="level3" data-number="17.3.2">
<h3 data-number="17.3.2" class="anchored" data-anchor-id="the-arbitrage-theorem"><span class="header-section-number">17.3.2</span> The Arbitrage Theorem</h3>
<p>Consider an experiment whose set of possible outcomes is <span class="math inline">\(S = \{1, 2, \dots, m\}\)</span>. Suppose that <span class="math inline">\(n\)</span> wagers are available. If the amount <span class="math inline">\(x\)</span> is bet on wager <span class="math inline">\(i\)</span>, then the return <span class="math inline">\(xr_i(j)\)</span> is earned if the outcome of the experiment is <span class="math inline">\(j\)</span>. In other words, <span class="math inline">\(r_i (\cdot)\)</span> is the return function for a unit bet on wager <span class="math inline">\(i\)</span>. The amount bet on a wager is allowed to be either positive or negative or zero.</p>
<p>A betting scheme is a vector <span class="math inline">\(\boldsymbol{x} = (x_1, \dots, x_n)\)</span> with the interpretation that <span class="math inline">\(x_1\)</span> is bet on wager <span class="math inline">\(1\)</span>, <span class="math inline">\(x_2\)</span> on wager <span class="math inline">\(2\)</span>, . . . , and <span class="math inline">\(x_n\)</span> on wager <span class="math inline">\(n\)</span>. If the outcome of the experiment is <span class="math inline">\(j\)</span>, then the return from the betting scheme <span class="math inline">\(\boldsymbol{x}\)</span> is <span class="math display">\[
\text{return from } \boldsymbol{x} = \sum_{i=1}^n x_ir_i(j)
\]</span></p>
<p>The following theorem states that either there exists a probability vector <span class="math inline">\(\boldsymbol{p} =
(p_1, \dots, p_m)\)</span> on the set of possible outcomes of the experiment under which each of the wagers has expected return 0, or else there is a betting scheme that guarantees a positive win.</p>
<div id="thm-thm1" class="theorem">
<p><span class="theorem-title"><strong>Theorem 17.1</strong></span> (The Arbitrage Theorem) Exactly one of the following is true: Either</p>
<ol type="i">
<li>there exists a probability vector <span class="math inline">\(\boldsymbol{p} = (p_1, \dots, p_m)\)</span> for which <span class="math display">\[
\sum_{j=1}^m p_j r_i(j) = 0,\quad \text{for all }i=1,\dots,n
\]</span> or</li>
<li>there exists a betting scheme <span class="math inline">\(\boldsymbol{x} = (x_1, \dots, x_n)\)</span> for which <span class="math display">\[
\sum_{i=1}^n x_i r_i(j) \gt 0,\quad \text{for all }j=1,\dots,m
\]</span></li>
</ol>
</div>
<p>In other words, if <span class="math inline">\(X\)</span> is the outcome of the experiment, then the arbitrage theorem states that either there is a probability vector <span class="math inline">\(\boldsymbol{p}\)</span> for X such that <span class="math display">\[
E_{\boldsymbol{p}}[r_i(X)] = 0, \quad \text{ for all  } i = 1, \dots, n
\]</span> or else there is a betting scheme that leads to a sure win.</p>
<div id="rem-rem1" class="proof remark">
<p><span class="proof-title"><em>Remark 17.1</em>. </span>This theorem is a consequence of the (linear algebra) theorem of the separating hyperplane, which is often used as a mechanism to prove the duality theorem of linear programming.</p>
<p>The theory of linear programming can be used to determine a betting strategy that guarantees the greatest return. Suppose that the absolute value of the amount bet on each wager must be less than or equal to 1. To determine the vector <span class="math inline">\(x\)</span> that yields the greatest guaranteed win—call this win <span class="math inline">\(v\)</span>—we need to choose <span class="math inline">\(\boldsymbol{x}\)</span> and <span class="math inline">\(v\)</span> so as to maximize <span class="math inline">\(v\)</span>, subject to the constraints <span class="math display">\[
\begin{align*}
\sum_{i=1}^n x_ir_i(j) &amp;\ge v, \quad \text{ for }j =1,\dots,m \\
-1 \le x_i &amp;\le 1, \quad i=1,\dots,n
\end{align*}
\]</span> This optimization problem is a linear program and can be solved by standard techniques (such as by using the simplex algorithm). The arbitrage theorem yields that the optimal <span class="math inline">\(v\)</span> will be positive unless there is a probability vector <span class="math inline">\(\boldsymbol{p}\)</span> for which <span class="math inline">\(\sum_{j=1}^m p_j r_i(j ) = 0\)</span> for all <span class="math inline">\(i=1,\dots,n\)</span>.</p>
</div>
<div id="exm-exa1" class="theorem example">
<p><span class="theorem-title"><strong>Example 17.1</strong></span> In some situations, the only types of wagers allowed are to choose one of the outcomes <span class="math inline">\(i, i = 1,\dots, m\)</span>, and bet that <span class="math inline">\(i\)</span> is the outcome of the experiment. The return from such a bet is often quoted in terms of “odds”. If the odds for outcome <span class="math inline">\(i\)</span> are <span class="math inline">\(o_i\)</span> (often written as “<span class="math inline">\(o_i\)</span> to <span class="math inline">\(1\)</span>”) then a 1 unit bet will return <span class="math inline">\(o_i\)</span> if the outcome of the experiment is <span class="math inline">\(i\)</span> and will return <span class="math inline">\(-1\)</span> otherwise. That is, <span class="math display">\[
r_i(j) =
\begin{cases}
o_i, &amp; \text{ if } j=i \\
-1 &amp; \text{ otherwise }
\end{cases}
\]</span> Suppose the odds <span class="math inline">\(o_1, \dots, o_m\)</span> are posted. In order for there not to be a sure win there must be a probability vector <span class="math inline">\(\boldsymbol{p} = (p_1, \dots, p_m)\)</span> such that <span class="math display">\[
0 \equiv E_{\boldsymbol{p}}[r_i(X)] = o_ip_i - (1-p_i)
\]</span> That is, we must have <span class="math display">\[
p_i = \frac{1}{1+o_i}
\]</span> Since the <span class="math inline">\(p_i\)</span> must sum to 1, this means that the condition for there not to be an arbitrage is that <span class="math display">\[
\sum_{i=1}^m (1+o_i)^{-1} = 1
\]</span> Thus, if the posted odds are such that <span class="math inline">\(\sum_{i=1}^m (1+o_i)^{-1} \ne 1\)</span>, then a sure win is possible. For instance, suppose there are three possible outcomes and the odds are as follows: <span class="math display">\[
\begin{array}{c}
\text{Outcome} &amp; \text{Odds} \\
1 &amp; 1 \\
2 &amp; 2 \\
3 &amp; 3
\end{array}
\]</span> That is, the odds for outcome 1 are 1 − 1, the odds for outcome 2 are 2 − 1, and that for outcome 3 are 3−1. Since <span class="math display">\[
\frac{1}{2} + \frac{1}{3} + \frac{1}{4} \gt 1
\]</span> a sure win is possible. One possibility is to bet $-1 on outcome 1 (and so you either win 1 if the outcome is not 1 and lose 1 if the outcome is 1) and bet <span class="math inline">\(-0.7\)</span> on outcome 2, and <span class="math inline">\(-0.5\)</span> on outcome 3. If the experiment results in outcome 1, then we win <span class="math inline">\(-1 + 0.7 + 0.5 = 0.2\)</span>; if it results in outcome 2, then we win <span class="math inline">\(1 -
1.4+0.5 = 0.1\)</span>; if it results in outcome 3, then we win <span class="math inline">\(1+0.7-1.5 = 0.2\)</span>. Hence, in all cases we win a positive amount.</p>
</div>
<div id="rem-rem2" class="proof remark">
<p><span class="proof-title"><em>Remark 17.3</em>. </span>If <span class="math inline">\(\sum_{i} (1+o_i)^{-1} \ne 1\)</span>, then the betting scheme <span class="math display">\[
x_i = \frac{(1+o_i)^{-1}}{1 - \sum_{i} (1+o_i)^{-1}}, \quad i=1,\dots,n
\]</span> will always yield a gain of exactly 1.</p>
</div>
<div id="exm-exa2" class="theorem example">
<p><span class="theorem-title"><strong>Example 17.2</strong></span> Let us reconsider the option pricing example of the previous section, where the initial price of a stock is 100 and the present value of the price at time 1 is either 200 or 50. At a cost of <span class="math inline">\(c\)</span> per share we can purchase at time 0 the option to buy the stock at time 1 at a present value price of 150 per share. The problem is to set the value of <span class="math inline">\(c\)</span> so that no sure win is possible.</p>
<p>In the context of this section, the outcome of the experiment is the value of the stock at time 1. Thus, there are two possible outcomes. There are also two different wagers: to buy (or sell) the stock, and to buy (or sell) the option. By the arbitrage theorem, there will be no sure win if there is a probability vector <span class="math inline">\((p, 1-p)\)</span> that makes the expected return under both wagers equal to 0.</p>
<p>Now, the return from purchasing 1 unit of the stock is <span class="math display">\[
\text{return}=
\begin{cases}
200-100=100,&amp;\text{if the price is 200 at time 1}\\
50-100=-50,&amp;\text{if the price is 50 at time 1}
\end{cases}
\]</span> Hence, if <span class="math inline">\(p\)</span> is the probability that the price is 200 at time 1, then <span class="math display">\[
E[\mathrm{return}]=100p-50(1-p)
\]</span> Setting this equal to 0 yields that <span class="math display">\[
p=\frac{1}{3}
\]</span> That is, the only probability vector <span class="math inline">\((p,1-p)\)</span> for which wager 1 yields an expected return 0 is the vector <span class="math inline">\((\frac{1}{3},\frac{2}{3}).\)</span></p>
<p>Now, the return from purchasing one share of the option is <span class="math display">\[
\text{return}=
\begin{cases}50-c,&amp;\text{if price is 200}\\[2ex]-c,&amp;\text{if price is 50}
\end{cases}
\]</span> Hence, the expected return when <span class="math inline">\(p=\frac{1}{3}\)</span> is <span class="math display">\[
\begin{align*}
E[\mathrm{return}]&amp;=(50-c)\frac{1}{3}-c\frac{2}{3}\\
&amp;=\frac{50}{3}-c
\end{align*}
\]</span> Thus, it follows from the arbitrage theorem that the only value of <span class="math inline">\(c\)</span> for which there will not be a sure win is <span class="math inline">\(c=\frac{50}{3}\)</span>, which verifies the result of <a href="#sec-example" class="quarto-xref"><span>Section 17.3.1</span></a>.</p>
</div>
</section>
</section>
<section id="the-black-scholes-option-pricing-formula" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="the-black-scholes-option-pricing-formula"><span class="header-section-number">17.4</span> The Black-Scholes Option Pricing Formula</h2>
<p>Suppose the present price of a stock is <span class="math inline">\(X(0)=x_0\)</span>, and let <span class="math inline">\(X(t)\)</span> denote its price at time <span class="math inline">\(t.\)</span> Suppose we are interested in the stock over the time interval 0 to <span class="math inline">\(T.\)</span> Assume that the discount factor is <span class="math inline">\(\alpha\)</span> (equivalently, the interest rate is <span class="math inline">\(100\alpha\)</span> percent compounded continuously), and so the present value of the stock price at time <span class="math inline">\(t\)</span> is <span class="math inline">\(e^{-\alpha t}X(t).\)</span></p>
<p>We can regard the evolution of the price of the stock over time as our experiment, and thus the outcome of the experiment is the value of the function <span class="math inline">\(X(t)\)</span>, <span class="math inline">\(0\leqslant t\leqslant T.\)</span> The types of wagers available are that for any <span class="math inline">\(s&lt;t\)</span> we can observe the process for a time <span class="math inline">\(s\)</span> and then buy (or sell) shares of the stock at price <span class="math inline">\(X(s)\)</span> and then sell (or buy) these shares at time <span class="math inline">\(t\)</span> for the price <span class="math inline">\(X(t).\)</span> In addition, we will suppose that we may purchase any of <span class="math inline">\(N\)</span> different options at time 0. Option <span class="math inline">\(i\)</span>, costing <span class="math inline">\(c_i\)</span> per share, gives us the option of purchasing shares of the stock at time <span class="math inline">\(t_i\)</span> for the fixed price of <span class="math inline">\(K_i\)</span> per share, <span class="math inline">\(i=1,\ldots,N.\)</span></p>
<p>Suppose we want to determine values of the <span class="math inline">\(c_i\)</span> for which there is no betting strategy that leads to a sure win. Assuming that the arbitrage theorem can be generalized (to handle the preceding situation, where the outcome of the experiment is a function), it follows that there will be no sure win if and only if there exists a probability measure over the set of outcomes under which all of the wagers have expected return 0. Let P be a probability measure on the set of outcomes. Consider first the wager of observing the stock for a time s and then purchasing (or selling) one share with the intention of selling (or purchasing) it at time <span class="math inline">\(t, 0\leqslant s&lt;t\leqslant T.\)</span> The present value of the amount paid for the stock is <span class="math inline">\(e^{-\alpha sX(s)}\)</span>, whereas the present value of the amount received is <span class="math inline">\(e^{-\alpha tX(t)}.\)</span> Hence, in order for the expected return of this wager to be 0 when <span class="math inline">\(P\)</span> is the probability measure on <span class="math inline">\(X(t),0\leqslant t\leqslant T\)</span>, we must have that <span id="eq-eq10-9"><span class="math display">\[
E_{\mathbf{P}}[e^{-\alpha t}X(t)|X(u),0\leqslant u\leqslant s]=e^{-\alpha s}X(s)
\tag{17.2}\]</span></span></p>
<p>Consider now the wager of purchasing an option. Suppose the option gives us the right to buy one share of the stock at time <span class="math inline">\(t\)</span> for a price <span class="math inline">\(K.\)</span> At time <span class="math inline">\(t\)</span>, the worth of this option will be as follows: <span class="math display">\[
\text{worth of option at time}\:t=
\begin{cases}
X(t)-K,&amp;\quad\text{if}\:X(t)\geqslant K\\
0,&amp;\quad\text{if}\:X(t)&lt;K
\end{cases}
\]</span> That is, the time <span class="math inline">\(t\)</span> worth of the option is <span class="math inline">\((X(t)-K)^+.\)</span> Hence, the present value of the worth of the option is <span class="math inline">\(e^{-\alpha t}\left(X\left(t\right)-K\right)^+.\)</span> If <span class="math inline">\(c\)</span> is the (time 0) cost of the option, we see that, in order for purchasing the option to have expected (present value) return 0, we must have that <span id="eq-eq10-10"><span class="math display">\[
E_\mathbf{P}[e^{-\alpha t}(X(t)-K)^+]=c
\tag{17.3}\]</span></span></p>
<p>By the arbitrage theorem, if we can find a probability measure P on the set of outcomes that satisfies <a href="#eq-eq10-9" class="quarto-xref">Equation&nbsp;<span>17.2</span></a>, then if <span class="math inline">\(c\)</span>, the cost of an option to purchase one share at time <span class="math inline">\(t\)</span> at the fixed price <span class="math inline">\(K\)</span> , is as given in <a href="#eq-eq10-10" class="quarto-xref">Equation&nbsp;<span>17.3</span></a>, then no arbitrage is possible. On the other hand, if for given prices <span class="math inline">\(c_i, i=1,\ldots,N\)</span>, there is no probability measure P that satisfies both <a href="#eq-eq10-9" class="quarto-xref">Equation&nbsp;<span>17.2</span></a> and the equality <span class="math display">\[
c_{i}=E_{\mathbf{P}}[e^{-\alpha t_{i}}(X(t_{i})-K_{i})^{+}],\quad i=1,\ldots,N
\]</span> then a sure win is possible.</p>
<p>We will now present a probability measure P on the outcome <span class="math inline">\(X(t),0\leqslant t\leqslant T\)</span>, that satisfies <a href="#eq-eq10-9" class="quarto-xref">Equation&nbsp;<span>17.2</span></a>.</p>
<p>Suppose that <span class="math display">\[
X(t)=x_0e^{Y(t)}
\]</span> where <span class="math inline">\(\{Y(t),t\geqslant0\}\)</span> is a Brownian motion process with drift coefficient <span class="math inline">\(\mu\)</span> and variance parameter <span class="math inline">\(\sigma^2.\)</span> That is, <span class="math inline">\(\{X(t),t\geqslant0\}\)</span> is a geometric Brownian motion process. From <a href="#eq-eq10-8" class="quarto-xref">Equation&nbsp;<span>17.1</span></a> we have that, for <span class="math inline">\(s\lt t\)</span>, <span class="math display">\[
E[X(t)|X(u),0\leqslant u\leqslant s]=X(s)e^{(t-s)(\mu+\sigma^{2}/2)}
\]</span> Hence, if we choose <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> so that <span class="math display">\[
\mu+\sigma^2/2=\alpha
\]</span> then <a href="#eq-eq10-9" class="quarto-xref">Equation&nbsp;<span>17.2</span></a> will be satisfied. That is, by letting P be the probability measure governing the stochastic process <span class="math inline">\(\{x_0e^{Y(t)}, 0\leqslant t\leqslant T\}\)</span>, where <span class="math inline">\(\{Y(t)\}\)</span> is Brownian motion with drift parameter <span class="math inline">\(\mu\)</span> and variance parameter <span class="math inline">\(\sigma^2\)</span>, and where <span class="math inline">\(\mu+\sigma^2/2=\alpha\)</span>, <a href="#eq-eq10-9" class="quarto-xref">Equation&nbsp;<span>17.2</span></a> is satisfied.</p>
<p>It follows from the preceding that if we price an option to purchase a share of the stock at time <span class="math inline">\(t\)</span> for a fixed price <span class="math inline">\(K\)</span> by <span class="math display">\[
c=E_{\mathbf{P}}[e^{-\alpha t}(X(t)-K)^{+}]
\]</span> then no arbitrage is possible. Since <span class="math inline">\(X(t)=x_0e^{Y(t)}\)</span>, where <span class="math inline">\(Y(t)\)</span> is normal with mean <span class="math inline">\(\mu t\)</span> and variance <span class="math inline">\(t\sigma^2\)</span>,we see that <span class="math display">\[
\begin{align*}
ce^{\alpha t}&amp;=\int_{-\infty}^{\infty}(x_{0}e^{y}-K)^{+}\frac{1}{\sqrt{2\pi t\sigma^{2}}}e^{-(y-\mu t)^{2}/2t\sigma^{2}}\:dy\\
&amp;=\int_{\log(K/x_{0})}^{\infty}(x_{0}e^{y}-K)\frac{1}{\sqrt{2\pi t\sigma^{2}}}e^{-(y-\mu t)^{2}/2t\sigma^{2}}\:dy
\end{align*}
\]</span> Making the change of variable <span class="math inline">\(w=(y-\mu t)/(\sigma t^{1/2})\)</span> yields <span id="eq-eq10-11"><span class="math display">\[
ce^{\alpha t}=x_{0}e^{\mu t}\frac{1}{\sqrt{2\pi}}\int_{a}^{\infty}e^{\sigma w\sqrt{t}}e^{-w^{2}/2}\:dw-K\frac{1}{\sqrt{2\pi}}\int_{a}^{\infty}e^{-w^{2}/2}\:dw
\tag{17.4}\]</span></span> where <span class="math display">\[
a=\frac{\log(K/x_0)-\mu t}{\sigma\sqrt{t}}
\]</span> Now, <span class="math display">\[
\begin{align*}
\frac{1}{\sqrt{2\pi}}\int_{a}^{\infty}e^{\sigma w\sqrt{t}}e^{-w^{2}/2}\:dw&amp;=e^{t\sigma^{2}/2}\frac{1}{\sqrt{2\pi}}\int_{a}^{\infty}e^{-(w-\sigma\sqrt{t})^{2}/2}\:dw\\
&amp;=e^{t\sigma^{2}/2}P\{N(\sigma\sqrt{t},1)\geqslant a\}\\
&amp;=e^{t\sigma^{2}/2}P\{N(0,1)\geqslant a-\sigma\sqrt{t}\}\\
&amp;=e^{t\sigma^{2}/2}P\{N(0,1)\leqslant-(a-\sigma\sqrt{t})\}\\
&amp;=e^{t\sigma^{2}/2}\phi\left(\sigma\sqrt{t}-a\right)
\end{align*}
\]</span> where <span class="math inline">\(N(m,v)\)</span> is a normal random variable with mean <span class="math inline">\(m\)</span> and variance <span class="math inline">\(v\)</span>, and <span class="math inline">\(\phi\)</span> is the standard normal distribution function.</p>
<p>Thus, we see from <a href="#eq-eq10-11" class="quarto-xref">Equation&nbsp;<span>17.4</span></a> that <span class="math display">\[
ce^{\alpha t}=x_{0}e^{\mu t+\sigma^{2}t/2}\phi\big(\sigma\sqrt{t}-a\big)-K\phi(-a)
\]</span> Using that <span class="math display">\[
\mu+\sigma^2/2=\alpha
\]</span> and letting <span class="math inline">\(b=-a\)</span>, we can write this as follows: <span id="eq-eq10-12"><span class="math display">\[
c=x_0\phi\big(\sigma\sqrt{t}+b\big)-Ke^{-\alpha t}\phi(b)
\tag{17.5}\]</span></span> where <span class="math display">\[
b=\frac{\alpha t-\sigma^2t/2-\log(K/x_0)}{\sigma\sqrt{t}}
\]</span></p>
<p>The option price formula given by <a href="#eq-eq10-12" class="quarto-xref">Equation&nbsp;<span>17.5</span></a> depends on the initial price of the stock <span class="math inline">\(x_0\)</span>, the option exercise time <span class="math inline">\(t\)</span>, the option exercise price <span class="math inline">\(K\)</span>, the discount (or interest rate) factor <span class="math inline">\(\alpha\)</span>, and the value <span class="math inline">\(\sigma^2.\)</span> Note that for any value of <span class="math inline">\(\sigma^2\)</span>, if the options are priced according to the formula of <a href="#eq-eq10-12" class="quarto-xref">Equation&nbsp;<span>17.5</span></a> then no arbitrage is possible. However, as many people believe that the price of a stock actually follows a geometric Brownian motion—that is, <span class="math inline">\(X(t)=x_0e^{Y(t)}\)</span> where <span class="math inline">\(Y(t)\)</span> is Brownian motion with parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2—\)</span>it has been suggested that it is natural to price the option according to the formula <a href="#eq-eq10-12" class="quarto-xref">Equation&nbsp;<span>17.5</span></a> with the parameter <span class="math inline">\(\sigma^2\)</span> taken equal to the estimated value (see the remark that follows) of the variance parameter under the assumption of a geometric Brownian motion model. When this is done, the formula <a href="#eq-eq10-12" class="quarto-xref">Equation&nbsp;<span>17.5</span></a> is known as the Black-Scholes option cost valuation. It is interesting that this valuation does not depend on the value of the drift parameter <span class="math inline">\(\mu\)</span> but only on the variance parameter <span class="math inline">\(\sigma^2.\)</span></p>
<p>If the option itself can be traded, then the formula of <a href="#eq-eq10-12" class="quarto-xref">Equation&nbsp;<span>17.5</span></a> can be used to set its price in such a way so that no arbitrage is possible. If at time <span class="math inline">\(s\)</span> the price of the stock is <span class="math inline">\(X(s)=x_s\)</span>, then the price of a <span class="math inline">\((t,K)\)</span> option—that is, an option to purchase one unit of the stock at time <span class="math inline">\(t\)</span> for a price <span class="math inline">\(K\)</span>—should be set by replacing <span class="math inline">\(t\)</span> by <span class="math inline">\(t-s\)</span> and <span class="math inline">\(x_0\)</span> by <span class="math inline">\(x_s\)</span> in <a href="#eq-eq10-12" class="quarto-xref">Equation&nbsp;<span>17.5</span></a>.</p>
<div id="rem-rem2" class="proof remark">
<p><span class="proof-title"><em>Remark 17.3</em>. </span>If we observe a Brownian motion process with variance parameter <span class="math inline">\(\sigma^2\)</span> over any time interval, then we could theoretically obtain an arbitrarily precise estimate of <span class="math inline">\(\sigma^2.\)</span> For suppose we observe such a process <span class="math inline">\(\{Y(s)\}\)</span> for a time <span class="math inline">\(t.\)</span> Then, for fixed <span class="math inline">\(h\)</span>, let <span class="math inline">\(N=[t/h]\)</span> and set <span class="math display">\[
\begin{align*}
&amp;W_{1}=Y(h)-Y(0),\\
&amp;W_{2}=Y(2h)-Y(h),\\
&amp;\vdots \\
&amp;W_{N}=Y(Nh)-Y(Nh-h)
\end{align*}
\]</span> Then random variables <span class="math inline">\(W_1,\ldots,W_N\)</span> are independent and identically distributed normal random variables having variance <span class="math inline">\(h\sigma^{\dot{2}}.\)</span> We now use the fact that <span class="math inline">\((N-1)S^2/(\sigma^2h)\)</span> has a chi-squared distribution with <span class="math inline">\(N-1\)</span> degrees of freedom, where <span class="math inline">\(S^2\)</span> is the sample variance defined by <span class="math display">\[
S^2=\sum_{i=1}^N(W_i-\overline{W})^2/(N-1)
\]</span> Since the expected value and variance of a chi-squared with <span class="math inline">\(k\)</span> degrees of freedom are equal to <span class="math inline">\(k\)</span> and <span class="math inline">\(2k\)</span>, respectively, we see that <span class="math display">\[
E[(N-1)S^2/(\sigma^2h)]=N-1
\]</span> and <span class="math display">\[
\mathrm{Var}[(N-1)S^2/(\sigma^2h)]=2(N-1)
\]</span> From this, we see that <span class="math display">\[
E[S^2/h]=\sigma^2
\]</span> and <span class="math display">\[
\mathrm{Var}[S^{2}/h]=2\sigma^{4}/(N-1)
\]</span> Hence, as we let <span class="math inline">\(h\)</span> become smaller (and so <span class="math inline">\(N=[t/h]\)</span> becomes larger) the variance of the unbiased estimator of <span class="math inline">\(\sigma^2\)</span> becomes arbitrarily small.</p>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Lecture16.html" class="pagination-link" aria-label="Brownian Motion">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Brownian Motion</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Lecture18.html" class="pagination-link" aria-label="Introduction to Monte Carlo Simulation">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Monte Carlo Simulation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>